<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Two Quick Things I learned about JSON in Go Chris Coyier - PicoD</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="You dont have to json.Unmarshal into an empty struct. I learned with examples like this: There, post is totally defaults, meaning because favorite_count was missing in the JSON data, post.FavoriteCount defaults to 0, the Go default value for an int. But it doesnt have to start that way! You can Unmarshal it into a variable"><meta name=robots content="index,follow,noarchive"><meta property="og:title" content="Two Quick Things I learned about JSON in Go  Chris Coyier"><meta property="og:description" content="You dont have to json.Unmarshal into an empty struct. I learned with examples like this: There, post is totally defaults, meaning because favorite_count was missing in the JSON data, post.FavoriteCount defaults to 0, the Go default value for an int. But it doesnt have to start that way! You can Unmarshal it into a variable"><meta property="og:type" content="article"><meta property="og:url" content="/two-quick-things-i-learned-about-json-in-go.html"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-08-28T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-28T00:00:00+00:00"><meta itemprop=name content="Two Quick Things I learned about JSON in Go  Chris Coyier"><meta itemprop=description content="You dont have to json.Unmarshal into an empty struct. I learned with examples like this: There, post is totally defaults, meaning because favorite_count was missing in the JSON data, post.FavoriteCount defaults to 0, the Go default value for an int. But it doesnt have to start that way! You can Unmarshal it into a variable"><meta itemprop=datePublished content="2024-08-28T00:00:00+00:00"><meta itemprop=dateModified content="2024-08-28T00:00:00+00:00"><meta itemprop=wordCount content="432"><meta itemprop=keywords content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=https://assets.cdnweb.info/hugo/mainroad/css/style.css><link rel="shortcut icon" href=./favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=./index.html title=PicoD rel=home><div class="logo__item logo__text"><div class=logo__title>PicoD</div></div></a></div><div class=divider></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Two Quick Things I learned about JSON in Go Chris Coyier</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2024-08-28T00:00:00Z>August 28, 2024</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=./categories/blog/ rel=category>blog</a></span></div></div></header><div class="content post__content clearfix"><img src=https://cdn.statically.io/img/i0.wp.com/chriscoyier.net/wp-content/uploads/2021/07/IsUISvAq_400x400.jpg style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><h2 class=wp-block-heading><a href=# aria-hidden=true class=aal_anchor id=one></a>One.</h2><p>You don’t have to <code>json.Unmarshal</code> into an empty struct. I learned with examples like this:</p><pre class="wp-block-code ticss-6f805c47" aria-describedby=shcb-language-1 data-shcb-language-name=Go data-shcb-language-slug=go><span><code class="hljs language-go"><span class=hljs-keyword>type</span> Post <span class=hljs-keyword>struct</span> {FavoriteCount <span class=hljs-keyword>int</span> <span class=hljs-string>`json:"favorite_count"`</span>ID <span class=hljs-keyword>string</span> <span class=hljs-string>`json:"id"`</span>FullText <span class=hljs-keyword>string</span> <span class=hljs-string>`json:"full_text"`</span> } exampleJSON := []<span class=hljs-keyword>byte</span>(<span class=hljs-string>`{ "id": "098a9df8a90d8fad", "full_text": "Blah blah blah." }`</span>) <span class=hljs-keyword>var</span> post Post err := json.Unmarshal(exampleJSON, &amp;post) <span class=hljs-keyword>if</span> err != <span class=hljs-literal>nil</span> { fmt.Println(err) }</code></span><span class=shcb-language__label>Code language:</span> <span class=shcb-language__name>Go</span> <span class=shcb-language__paren>(</span><span class=shcb-language__slug>go</span><span class=shcb-language__paren>)</span></pre><p>There, <code>post</code> is totally defaults, meaning because <code>favorite_count</code> was missing in the JSON data, <code>post.FavoriteCount</code> defaults to 0, the Go default value for an <code>int</code>. But it doesn’t have to start that way! You can Unmarshal it into a variable of that type that isn’t all default values.</p><pre class=wp-block-code><span><code class=hljs>post := Post{FavoriteCount: 5, } err = json.Unmarshal(exampleJSON, &amp;post) if err != nil {fmt.Println(err) }</code></span></pre><p>Now even though the JSON data is still missing <code>favorite_count</code>, the <code>post.FavoriteCount</code> value will be <code>5</code>. Useful!</p><p>And surprising to me, as a language that doesn’t have much in the way of convience methods. Like there certainly is no <code>...spread</code> like JavaScript, and this feels a smidge like spreading.</p><p><a href=#>Here’s a thing on Replit.</a></p><p>Another thing I need to learn is how to deal better with Unmarshaling data into a struct where the JSON data could be wrong. With the default <code>json.Unmarshal</code> it just totally fails, and so far I’ve worked around it with really permissive temporary <code>type</code>s that use a bunch of <code>interface{}</code> shit and coercing it later. But I’d rather use a strict type and deal with it on the spot. I hear userland libs like <a href=#>mapstructure</a> and <a href=#>fastjson</a> can maybe help here.</p><h2 class=wp-block-heading><a href=# aria-hidden=true class=aal_anchor id=two></a>Two.</h2><p>Sometimes JSON is all like…</p><pre class=wp-block-code aria-describedby=shcb-language-2 data-shcb-language-name="JSON / JSON with Comments" data-shcb-language-slug=json><span><code class="hljs language-json">{ <span class=hljs-attr>"things"</span>: {[ <span class=hljs-attr>"thing: { } ]} }</span></code></span><span class=shcb-language__label>Code language:</span> <span class=shcb-language__name>JSON / JSON with Comments</span> <span class=shcb-language__paren>(</span><span class=shcb-language__slug>json</span><span class=shcb-language__paren>)</span></pre><p>And sometimes JSON is all like:</p><pre class=wp-block-code aria-describedby=shcb-language-3 data-shcb-language-name="JSON / JSON with Comments" data-shcb-language-slug=json><span><code class="hljs language-json">[{ <span class=hljs-attr>"thing"</span>: { } }]</code></span><span class=shcb-language__label>Code language:</span> <span class=shcb-language__name>JSON / JSON with Comments</span> <span class=shcb-language__paren>(</span><span class=shcb-language__slug>json</span><span class=shcb-language__paren>)</span></pre><p>I was somehow under the wrong impression that the first example was somehow better. It might be in some cases, like where you might use like <code>things_v2</code> as an opportunity to “version” the JSON, but generally, I actually think the second example is cleaner.</p><p>The second is also easier to deal with in Go, as you don’t need an additional “parent” type to deal with “things”. You can just make the main type a <code>[]slice</code> and it knows what it’s looking for will be an array in the JSON then.</p><pre class=wp-block-code aria-describedby=shcb-language-4 data-shcb-language-name=Go data-shcb-language-slug=go><span><code class="hljs language-go shcb-code-table"><span class=shcb-loc><span><span class=hljs-keyword>type</span> testURL <span class=hljs-keyword>struct</span> { </span></span><span class=shcb-loc><span> Title <span class=hljs-keyword>string</span> <span class=hljs-string>`json:"title"`</span> </span></span><span class=shcb-loc><span> Value <span class=hljs-keyword>string</span> <span class=hljs-string>`json:"value"`</span> </span></span><span class=shcb-loc><span>} </span></span><span class=shcb-loc><span> </span></span><span class=shcb-loc><span>exampleJSON := []<span class=hljs-keyword>byte</span>(<span class=hljs-string>`[</span> </span></span><span class=shcb-loc><span><span class=hljs-string> {"title": "Homepage", "value": "https://nextjs.org/"},</span> </span></span><span class=shcb-loc><span><span class=hljs-string> {"title": "GitHub", "value": "https://github.com/vercel/next.js/"},</span> </span></span><span class=shcb-loc><span><span class=hljs-string> {"title": "Docs", "value": "https://nextjs.org/docs"}</span> </span></span><span class=shcb-loc><span><span class=hljs-string>]`</span>) </span></span><span class=shcb-loc><span> </span></span><span><span class=hljs-keyword>var</span> allURLs []testURL </span><span class=shcb-loc><span> </span></span><span class=shcb-loc><span>err := json.Unmarshal(exampleJSON, &amp;allURLs) </span></span><span class=shcb-loc><span><span class=hljs-keyword>if</span> err != <span class=hljs-literal>nil</span> { </span></span><span class=shcb-loc><span> fmt.Println(err) </span></span><span class=shcb-loc><span>} </span></span></code></span><span class=shcb-language__label>Code language:</span> <span class=shcb-language__name>Go</span> <span class=shcb-language__paren>(</span><span class=shcb-language__slug>go</span><span class=shcb-language__paren>)</span></pre><p><a href=#>Here’s a Replit thing.</a></p><p><h3 class=jp-relatedposts-headline>Related</h3></p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmibmKe2tK%2FOsqCeql6jsrV7kWlpa2dhZnxyfI6trqhloaq2pLeMrZ%2Bippeoeqp5y56Yq6aVmXqirs6uq2aio6S7brXNZp6oZw%3D%3D</p></div></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=./wifes-heartbreaking-words-tradie-husband-matthew-milner-died-freak-workplace-accident-perth-html.html rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>Wife's heartbreaking words after her tradie husbandMatthew Milner died in freak workplace accident</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=./415880-kenneth-kaunda-zambias-first-presidents-memorable-quotes-html.html rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>Kenneth Kaunda: Zambia's First President's Memorable Quotes</p></a></div></nav></div><aside class=sidebar><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=./easy-pumpkin-desserts-using-premade-pie.html>2 Easy Desserts Made Using One Pumpkin Pie</a></li><li class=widget__item><a class=widget__link href=./nick-jonas-priyanka-chopra-celebrate-baby-malti-first-birthday-following-hospitalization.html>Nick Jonas and Priyanka Chopra celebrate baby Malti's first birthday 'in style'</a></li><li class=widget__item><a class=widget__link href=./janelle-monae-vanity-fair-party-dress-oscars-2022.html>See Janelle Mone's Cutout Dress from the Oscars 2022 Party</a></li><li class=widget__item><a class=widget__link href=./aljamain-sterling-girlfriend.html>Who is Aljamain Sterlings girlfriend?</a></li><li class=widget__item><a class=widget__link href=./anti-aging-skincare-tools-review.html>Are These Devices Worth the Money?</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=./categories/blog/>blog</a></li></ul></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2024 PicoD.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=https://assets.cdnweb.info/hugo/mainroad/js/menu.js></script>
<script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>